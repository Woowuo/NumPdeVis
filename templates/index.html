<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NumPdeVis</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
	<link rel="icon" href="/static/favicon.ico" type="image/x-icon">
	<link href='http://cdn.repository.webfont.com/webfonts/nomal/154120/46931/661ba89aa75bea15a0a6d4c1.css' rel='stylesheet' type='text/css' />
	<script>
	    window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], }, chtml: { scale: 0.8 }};
	</script>
	<script src='https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js'></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

</head>
<body>
    <header>
		
		<div class="logo-tittle">
               <div class="logo">
                  <a href="{{ url_for('index') }}"><img src="/static/logo.png" alt="Logo" style="height: 70px;"> <!-- 调整高度以适应你的布局需求 --></a>
               </div>
		       <div class="logo-text"><a href="{{ url_for('index') }}">NumPdeVis</a></div>
            </div>
		

        <nav>
            <ul>
                <li><a href="{{ url_for('index') }}">Home</a></li>
                <li><a href="{{ url_for('about') }}">About</a></li>
                <li><a href="{{ url_for('contact') }}">Contact</a></li>
            </ul>
        </nav>
    </header>
    <main class="content">
        <section class="banner">
            <h1>NumPdeVis can support Latex on html now!</h1><br>
<!-- 			<div class="text-horizontal"> -->
				<p>Infinite Series: $\sum_{n=1}^{\infty} \frac{1}{n^2} = \frac{\pi^2}{6}$</p><br>
<!--            </div> -->
			<p>Integral Formula: $\int_a^b f(x)\,dx = F(b) - F(a)$</p><br>
			<p>Euler's Formula: $e^{i\pi} + 1 = 0$</p>
			    
			    <div class=data-form>
			        <p>Test:</p>
			        <input type="text" id="userInput" placeholder="请以latex语法输入...">
                    <button onclick="printInput()">转换</button>
			    </div>
			<p id="display"></p>
			    
        </section>
		

		
        <section class="information">
            <h1 class="information1">Numeric Visualization of Partial Derivative Equation</h1>
            <div class="information-item">****************************************<br>*****************************<br>******************<br>*****************************************************<br>************************************</div>
<!--            <div class="information-item">功能2</div>
            <div class="information-item">功能3</div> -->
        </section>
		
		<section class="example">
			<div>
				<h1>Example show</h1>
				<p>This is an example by taichi</p>
			</div>
			<div class="video-container">
			        <video autoplay loop muted class="background-video">
			            <source src="/static/videos/julia_set.mp4" type="video/mp4">
			            Your browser does not support the video tag.
			        </video>
			</div>

		</section>
		
		<section class="laplace">
			<div class="formula-options">
				<button id="btn-A" onclick="switchFormula('A')">Wave Equation</button>
				<button id="btn-B" onclick="switchFormula('B')">Heat Conduction Equation</button>
				<button id="btn-C" onclick="switchFormula('C')">Laplace Equation</button>
				<button id="reset-taichi">重置 Taichi 环境</button>


				
				
			</div>
			
			
			<br>
			    <!-- 现有的单输入框表单，用于Wave Equation和Heat Conduction Equation -->
			    <form id="heatForm" class="dataform">
			        <input type="text" name="data" placeholder="Enter your data here..." class="input-field">
			        <button type="submit" class="solve-button">Solve</button>
			    </form>
				
				<form id="waveForm" class="dataform laplace-inputs" style="display:none;">
					<input type="text" name="con1" placeholder="\sinx" class="input-field">
					<input type="text" name="con2" placeholder="\cosx" class="input-field">
					
					<input type="text" name="dim" placeholder="Dim" class="input-field">
					<span class="bracket">[</span>
				    <input type="text" name="len_1" placeholder="Len" class="input-field">, 
					<input type="text" name="len_2" placeholder="Len" class="input-field">, 
					<input type="text" name="len_3" placeholder="Len" class="input-field">
					<span class="bracket">]</span>
				    
					<span class="bracket">[</span>
				    <input type="text" name="dw1" placeholder="dt" class="input-field">, 
					<input type="text" name="dw2" placeholder="dx" class="input-field">, 
					<input type="text" name="dw3" placeholder="dy" class="input-field">,
					<input type="text" name="dw4" placeholder="dz" class="input-field">
					<span class="bracket">]</span>
					<span class="bracket">[</span>
				    <input type="text" name="a1" placeholder="a1" class="input-field">, 
					<input type="text" name="a2" placeholder="a2" class="input-field">, 
					<input type="text" name="a3" placeholder="a3" class="input-field">
					<span class="bracket">]</span>
					<span class="bracket">[</span>
				    <input type="text" name="b1" placeholder="b1" class="input-field">, 
					<input type="text" name="b2" placeholder="b2" class="input-field">, 
					<input type="text" name="b3" placeholder="b3" class="input-field">
					<span class="bracket">]</span>
					<input type="text" name="v" placeholder="Velocity" class="input-field">
				    <button type="submit" class="solve-button">Solve</button>
				</form>
			    
			    <!-- 新的五输入框表单，仅用于Laplace Equation -->
			    <form id="laplaceForm" class="dataform laplace-inputs" style="display:none;">
					<input type="text" name="dim" placeholder="Dim" class="input-field">
					<span class="bracket">[</span>
			        <input type="text" name="len_1" placeholder="Len" class="input-field">, 
					<input type="text" name="len_2" placeholder="Len" class="input-field">, 
					<input type="text" name="len_3" placeholder="Len" class="input-field">
					<span class="bracket">]</span>
			        
					<span class="bracket">[</span>
			        <input type="text" name="dw1" placeholder="dt" class="input-field">, 
					<input type="text" name="dw2" placeholder="dx" class="input-field">, 
					<input type="text" name="dw3" placeholder="dy" class="input-field">
					<span class="bracket">]</span>
					<span class="bracket">[</span>
			        <input type="text" name="a1" placeholder="a1." class="input-field">, 
					<input type="text" name="a2" placeholder="a2." class="input-field">, 
					<input type="text" name="a3" placeholder="a3." class="input-field">
					<span class="bracket">]</span>
					<span class="bracket">[</span>
			        <input type="text" name="b1" placeholder="b1" class="input-field">, 
					<input type="text" name="b2" placeholder="b2" class="input-field">, 
					<input type="text" name="b3" placeholder="b3" class="input-field">
					<span class="bracket">]</span>
			        <button type="submit" class="solve-button">Solve</button>
			    </form>
<!--                <div class="image-frame">
			           <img id="resultImage" src="" alt="Result will be shown here" style="display:none;">
			    </div> -->
				<div id=videoContainer>
				    <video id="videoPlayer" width="320" height="240" controls>
				          Your browser does not support the video tag.
				    </video>
				</div>
				<div id="plotDivContainer" style="margin: 0 auto; width: 50%;">
				    
					{{ plot_div|safe }}
				</div>
				
			    <script>
					



					
				    document.getElementById('reset-taichi').addEventListener('click', function() {
				        fetch('/reset-taichi', { method: 'POST' })
				        .then(response => response.json())
				        .then(data => {
				            if (data.success) {
				                alert('Taichi 环境已重置！');
				            } else {
				                alert('重置失败: ' + data.error);
				            }
				        })
				        .catch(error => {
				            console.error('Error:', error);
				            alert('重置请求失败');
				        });
				    });


                    function switchFormula(formula) {
                        // 移除所有按钮的'selected'类
                        document.querySelectorAll('.formula-options button').forEach(function(btn) {
                            btn.classList.remove('selected');
                        });
                    
                        // 添加'selected'类到点击的按钮
                        document.getElementById('btn-' + formula).classList.add('selected');
                    
                        // 隐藏所有表单
                        document.getElementById('waveForm').style.display = 'none';
                        document.getElementById('heatForm').style.display = 'none';
                        document.getElementById('laplaceForm').style.display = 'none';
                    
                        // 清空结果显示区域
                        var videoPlayer = document.getElementById("videoPlayer");
                        var plotDivContainer = document.getElementById("plotDivContainer");
                        videoPlayer.removeAttribute("src"); // 清除视频源
                        videoPlayer.load(); // 重新加载视频元素
                        plotDivContainer.innerHTML = ''; // 清空图表容器
                    
                        // 根据选择的方程显示表单和控制视频播放器的显示
                        if (formula === 'C') { // 如果选中的是Laplace方程
                            document.getElementById('laplaceForm').style.display = 'block';
                            videoPlayer.style.display = 'none'; // 隐藏视频播放器
                        } else {
                            if (formula === 'A') { // 如果选中的是Wave方程
                                document.getElementById('waveForm').style.display = 'block';
                            } else if (formula === 'B') { // 如果选中的是Heat Conduction方程
                                document.getElementById('heatForm').style.display = 'block';
                            }
                            videoPlayer.style.display = 'block'; // 显示视频播放器
                        }
                    }


                    

                    
                    // 初始化，默认选择第一个方程
                    switchFormula('A');
                       $(document).ready(function(){
                           $("#waveForm").submit(function(event){
                               event.preventDefault(); // 阻止表单默认提交行为
                               $.ajax({
                                   type: "POST",
                                   url: "/wave",
                                   data: $(this).serialize(),
                                   success: function(response){
                                       // 假设 response.video_url 是你的视频文件的新路径
                                       var newVideoUrl = response.video_wave; // 确保这个变量包含了正确的视频路径
                                       var videoPlayer = $("#videoPlayer");
                                       
                                       videoPlayer.attr("src", newVideoUrl); // 更新视频路径
                                       videoPlayer[0].load(); // 重新加载视频元素，确保新视频可以播放
                                       videoPlayer[0].play(); // 自动播放新视频
                                   }
                               });
                           });
                       });

 
					
					$(document).ready(function(){
					    $("#laplaceForm").submit(function(event){
					        event.preventDefault(); // 阻止表单的默认提交行为
					        $.ajax({
					            type: "POST",
					            url: "/laplace", // Flask后端的URL
					            data: $(this).serialize(), // 序列化表单数据
					            success: function(response){
					                // 假设后端返回的response包含plot_div
					                $("#plotDivContainer").html(response.plot_div); // 将plotly图表嵌入页面指定的元素中
					            }
					        });
					    });
					});


					function printInput() {
    // 获取输入框的值
                         var input = "$" + document.getElementById("userInput").value + "$";

    // 将输入的值显示在指定的段落中
                         document.getElementById("display").innerText = input;
                         MathJax.typesetPromise();
					    
					}
			    </script>

		
		</section>
		
		
		
    </main>
    <footer>
        <p>Copyright © NumPdeVis.</p>
    </footer>
</body>
</html>
